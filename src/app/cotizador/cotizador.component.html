<div class="contenedor">
    <h2 class="titulo">ğŸ“„ Cotizador de BOM y Oferta</h2>

    <div class="inputs">
        <div class="input-group">
            <label for="bom">ğŸ“‚ Subir BOM</label>
            <input id="bom" type="file" (change)="onFileChange($event, 'bom')" accept=".xlsx" />
        </div>

        <div class="input-group">
            <label for="oferta">ğŸ“‚ Subir Oferta</label>
            <input id="oferta" type="file" (change)="onFileChange($event, 'oferta')" accept=".xlsx" />
        </div>
    </div>

    <button class="btn-procesar" (click)="procesarArchivos()">ğŸ”„ Procesar Archivos</button>

    <div *ngIf="errorMsg" class="error-msg">
        âš ï¸ {{ errorMsg }}
    </div>

    <div *ngIf="datosCombinados.length > 0" class="tabla-container" id="tablaCotizacion">
        <h3>ğŸ“‹ Resultado de la combinaciÃ³n</h3>
        <table>
            <thead>
                <tr>
                    <th *ngFor="let key of getColumnKeys()">{{ key }}</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let fila of datosCombinados">
                    <td *ngFor="let key of getColumnKeys()">{{ fila[key] || '' }}</td>
                </tr>
            </tbody>
        </table>

        <button class="btn-exportar" (click)="exportarExcel()">â¬‡ï¸ Exportar a Excel</button>
        <button class="btn-imprimir" (click)="imprimirTabla()">ğŸ–¨ï¸ Imprimir Tabla</button>
    </div>
</div>